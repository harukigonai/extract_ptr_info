#define _GNU_SOURCE

#include <stdio.h>
#include <dlfcn.h>
#include <sys/syscall.h>
#include <unistd.h>
#include <openssl/crypto.h>
#include <openssl/err.h>
#include <openssl/x509.h>
#include <openssl/x509v3.h>
#include <openssl/pem.h>
#include <openssl/pkcs12.h>
#include <openssl/ui.h>
#include <openssl/safestack.h>
#include <openssl/ssl.h>
#include <openssl/e_os2.h>
#include <openssl/crypto.h>
#include <openssl/err.h>
#include <openssl/ssl.h>
#include <openssl/evp.h>
#include <openssl/bn.h>
#include <openssl/x509v3.h>
#include <openssl/ocsp.h>
#include <openssl/srp.h>

#include "../arg_struct.h"

X509 * bb_SSL_get_certificate(const SSL * arg_a);

X509 * SSL_get_certificate(const SSL * arg_a) 
{
    unsigned long in_lib = syscall(890);
    printf("SSL_get_certificate called %lu\n", in_lib);
    if (!in_lib)
        return bb_SSL_get_certificate(arg_a);
    else {
        X509 * (*orig_SSL_get_certificate)(const SSL *);
        orig_SSL_get_certificate = dlsym(RTLD_NEXT, "SSL_get_certificate");
        return orig_SSL_get_certificate(arg_a);
    }
}

X509 * bb_SSL_get_certificate(const SSL * arg_a) 
{
    X509 * ret;

    struct lib_enter_args args = {
        .num_args = 0,
        .entity_metadata = {
            1, 8, 1, /* 0: pointer.struct.iovec */
            	5, 0,
            0, 16, 1, /* 5: struct.iovec */
            	10, 0,
            1, 8, 1, /* 10: pointer.char */
            	4096, 0,
            0, 0, 0, /* 15: func */
            0, 16, 1, /* 18: struct.tls_session_ticket_ext_st */
            	10, 8,
            1, 8, 1, /* 23: pointer.struct.tls_session_ticket_ext_st */
            	18, 0,
            4097, 48, 94417279224736, /* 28: pointer.func */
            	0, 8,
            	1, 36,
            	0, 1,
            	8, 1,
            	31, 0,
            	1, 8,
            	1, 46,
            	0, 0,
            	24, 1,
            	36, 16,
            	0, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 44,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 1,
            	8, 1,
            	89, 0,
            	0, 4,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	144, 4,
            	121, 8,
            	121, 16,
            	141, 24,
            	153, 120,
            	1, 8,
            	1, 126,
            	0, 0,
            	32, 1,
            	131, 0,
            	0, 32,
            	1, 136,
            	8, 1,
            	8, 1,
            	10, 0,
            	1, 8,
            	1, 146,
            	0, 0,
            	56, 2,
            	10, 0,
            	121, 48,
            	0, 16,
            	1, 121,
            	0, 1,
            	8, 1,
            	110, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 296,
            	5, 200,
            	0, 620,
            	48, 714,
            	64, 746,
            	80, 828,
            	96, 1,
            	8, 1,
            	205, 0,
            	0, 24,
            	3, 214,
            	0, 377,
            	8, 612,
            	16, 1,
            	8, 1,
            	219, 0,
            	0, 184,
            	12, 246,
            	0, 286,
            	8, 276,
            	16, 10,
            	32, 153,
            	40, 276,
            	104, 542,
            	112, 556,
            	120, 121,
            	128, 121,
            	136, 582,
            	144, 594,
            	176, 1,
            	8, 1,
            	251, 0,
            	0, 104,
            	11, 276,
            	0, 276,
            	8, 286,
            	16, 327,
            	24, 351,
            	32, 327,
            	40, 363,
            	48, 276,
            	56, 276,
            	64, 121,
            	72, 537,
            	80, 1,
            	8, 1,
            	281, 0,
            	0, 24,
            	1, 10,
            	8, 1,
            	8, 1,
            	291, 0,
            	0, 16,
            	2, 298,
            	0, 312,
            	8, 1,
            	8, 1,
            	303, 0,
            	0, 40,
            	3, 10,
            	0, 10,
            	8, 10,
            	24, 1,
            	8, 1,
            	317, 0,
            	0, 16,
            	1, 322,
            	8, 0,
            	8, 1,
            	10, 0,
            	1, 8,
            	1, 332,
            	0, 0,
            	40, 3,
            	121, 0,
            	341, 16,
            	10, 24,
            	1, 8,
            	1, 346,
            	0, 0,
            	24, 1,
            	10, 8,
            	1, 8,
            	1, 356,
            	0, 0,
            	16, 2,
            	276, 0,
            	276, 8,
            	1, 8,
            	1, 368,
            	0, 0,
            	24, 3,
            	286, 0,
            	276, 8,
            	377, 16,
            	1, 8,
            	1, 382,
            	0, 0,
            	56, 4,
            	393, 16,
            	415, 24,
            	322, 32,
            	121, 48,
            	1, 8,
            	1, 398,
            	0, 0,
            	208, 3,
            	10, 16,
            	10, 24,
            	407, 32,
            	1, 8,
            	1, 412,
            	0, 0,
            	0, 0,
            	1, 8,
            	1, 420,
            	0, 0,
            	216, 13,
            	10, 0,
            	10, 8,
            	449, 16,
            	461, 24,
            	473, 32,
            	485, 40,
            	497, 48,
            	509, 56,
            	517, 64,
            	525, 160,
            	153, 184,
            	415, 200,
            	415, 208,
            	1, 8,
            	1, 454,
            	0, 0,
            	112, 2,
            	10, 0,
            	10, 80,
            	1, 8,
            	1, 466,
            	0, 0,
            	96, 2,
            	10, 0,
            	10, 72,
            	1, 8,
            	1, 478,
            	0, 0,
            	72, 2,
            	10, 0,
            	10, 56,
            	1, 8,
            	1, 490,
            	0, 0,
            	32, 2,
            	10, 0,
            	10, 24,
            	1, 8,
            	1, 502,
            	0, 0,
            	48, 2,
            	10, 0,
            	10, 40,
            	1, 8,
            	1, 514,
            	0, 0,
            	48, 0,
            	1, 8,
            	1, 522,
            	0, 0,
            	0, 0,
            	1, 8,
            	1, 530,
            	0, 0,
            	32, 2,
            	10, 8,
            	10, 16,
            	0, 24,
            	1, 10,
            	0, 1,
            	8, 1,
            	547, 0,
            	0, 24,
            	3, 276,
            	0, 121,
            	8, 276,
            	16, 1,
            	8, 1,
            	561, 0,
            	0, 40,
            	2, 568,
            	0, 121,
            	8, 1,
            	8, 1,
            	573, 0,
            	0, 32,
            	3, 298,
            	8, 121,
            	16, 121,
            	24, 1,
            	8, 1,
            	587, 0,
            	0, 16,
            	2, 121,
            	0, 121,
            	8, 1,
            	8, 1,
            	599, 0,
            	0, 40,
            	5, 121,
            	0, 121,
            	8, 276,
            	16, 276,
            	24, 121,
            	32, 1,
            	8, 1,
            	617, 0,
            	0, 120,
            	0, 1,
            	8, 1,
            	625, 0,
            	0, 168,
            	17, 449,
            	16, 415,
            	24, 662,
            	32, 662,
            	40, 662,
            	48, 662,
            	56, 662,
            	64, 662,
            	72, 662,
            	80, 662,
            	88, 153,
            	96, 680,
            	120, 680,
            	128, 680,
            	136, 10,
            	144, 694,
            	152, 694,
            	160, 1,
            	8, 1,
            	667, 0,
            	0, 24,
            	1, 672,
            	0, 1,
            	8, 1,
            	677, 0,
            	0, 4,
            	0, 1,
            	8, 1,
            	685, 0,
            	0, 96,
            	3, 667,
            	8, 667,
            	32, 667,
            	56, 1,
            	8, 1,
            	699, 0,
            	0, 88,
            	6, 662,
            	0, 662,
            	8, 662,
            	16, 662,
            	24, 5,
            	40, 680,
            	72, 1,
            	8, 1,
            	719, 0,
            	0, 144,
            	12, 662,
            	8, 662,
            	16, 662,
            	32, 662,
            	40, 680,
            	56, 662,
            	64, 662,
            	72, 10,
            	80, 662,
            	96, 153,
            	112, 473,
            	128, 415,
            	136, 1,
            	8, 1,
            	751, 0,
            	0, 56,
            	4, 762,
            	8, 800,
            	16, 662,
            	24, 816,
            	48, 1,
            	8, 1,
            	767, 0,
            	0, 232,
            	11, 792,
            	0, 800,
            	8, 667,
            	16, 667,
            	40, 10,
            	80, 816,
            	96, 667,
            	104, 667,
            	152, 667,
            	176, 10,
            	208, 10,
            	216, 1,
            	8, 1,
            	797, 0,
            	0, 304,
            	0, 1,
            	8, 1,
            	805, 0,
            	0, 88,
            	4, 792,
            	0, 667,
            	8, 667,
            	32, 667,
            	56, 1,
            	8, 1,
            	821, 0,
            	0, 40,
            	2, 816,
            	0, 10,
            	8, 0,
            	192, 8,
            	205, 0,
            	205, 24,
            	205, 48,
            	205, 72,
            	205, 96,
            	205, 120,
            	205, 144,
            	205, 168,
            	0, 0,
            	0, 0,
            	12, 0,
            	0, 248,
            	6, 121,
            	0, 200,
            	16, 828,
            	24, 620,
            	216, 714,
            	224, 746,
            	232, 0,
            	352, 14,
            	10, 144,
            	10, 152,
            	899, 168,
            	214, 176,
            	904, 224,
            	121, 240,
            	153, 248,
            	914, 264,
            	914, 272,
            	10, 280,
            	10, 296,
            	10, 312,
            	10, 320,
            	10, 344,
            	1, 8,
            	1, 853,
            	0, 1,
            	8, 1,
            	909, 0,
            	0, 88,
            	1, 10,
            	8, 1,
            	8, 1,
            	868, 0,
            	0, 56,
            	2, 926,
            	0, 153,
            	40, 1,
            	8, 1,
            	931, 0,
            	0, 64,
            	1, 10,
            	8, 1,
            	8, 1,
            	919, 0,
            	0, 168,
            	4, 952,
            	0, 415,
            	8, 10,
            	96, 10,
            	120, 1,
            	8, 1,
            	957, 0,
            	0, 88,
            	1, 10,
            	80, 4097,
            	0, 0,
            	1, 8,
            	1, 970,
            	0, 0,
            	24, 2,
            	10, 8,
            	965, 16,
            	4097, 0,
            	0, 0,
            	16, 0,
            	0, 2,
            	0, 0,
            	256, 0,
            	1, 8,
            	1, 994,
            	0, 0,
            	888, 7,
            	1011, 576,
            	1011, 592,
            	1016, 608,
            	1016, 616,
            	1011, 624,
            	1026, 648,
            	1026, 736,
            	0, 16,
            	1, 1016,
            	8, 1,
            	8, 1,
            	1021, 0,
            	0, 16,
            	1, 965,
            	0, 0,
            	88, 1,
            	1031, 48,
            	0, 40,
            	4, 1042,
            	0, 1047,
            	8, 936,
            	16, 914,
            	24, 1,
            	8, 1,
            	941, 0,
            	1, 8,
            	1, 1052,
            	0, 0,
            	48, 4,
            	612, 0,
            	415, 8,
            	10, 24,
            	1063, 32,
            	1, 8,
            	1, 1068,
            	0, 0,
            	80, 8,
            	1087, 0,
            	415, 8,
            	377, 16,
            	377, 24,
            	10, 40,
            	10, 48,
            	407, 56,
            	672, 64,
            	1, 8,
            	1, 1092,
            	0, 0,
            	208, 9,
            	407, 8,
            	407, 32,
            	407, 48,
            	407, 64,
            	407, 80,
            	407, 96,
            	407, 144,
            	407, 160,
            	407, 176,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 24,
            	2, 10,
            	8, 926,
            	16, 4097,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 9,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 1,
            	8, 1,
            	1209, 0,
            	0, 736,
            	30, 1272,
            	0, 121,
            	8, 121,
            	16, 158,
            	24, 84,
            	32, 914,
            	48, 914,
            	56, 10,
            	160, 10,
            	176, 153,
            	208, 612,
            	224, 612,
            	232, 612,
            	240, 121,
            	248, 121,
            	256, 121,
            	272, 1298,
            	304, 10,
            	328, 141,
            	392, 415,
            	408, 10,
            	424, 10,
            	496, 10,
            	512, 10,
            	520, 41,
            	552, 41,
            	560, 1303,
            	568, 10,
            	704, 10,
            	720, 121,
            	728, 1,
            	8, 1,
            	1277, 0,
            	0, 232,
            	1, 1282,
            	200, 1,
            	8, 1,
            	1287, 0,
            	0, 112,
            	4, 407,
            	0, 407,
            	32, 10,
            	64, 10,
            	80, 1,
            	8, 1,
            	187, 0,
            	0, 128,
            	11, 10,
            	0, 10,
            	32, 662,
            	40, 662,
            	48, 662,
            	56, 662,
            	64, 662,
            	72, 662,
            	80, 662,
            	88, 662,
            	96, 10,
            	104, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	8, 0,
            	4097, 0,
            	0, 0,
            	12, 0,
            	4097, 0,
            	0, 0,
            	128, 0,
            	0, 528,
            	8, 904,
            	408, 714,
            	416, 746,
            	424, 121,
            	464, 10,
            	480, 952,
            	488, 612,
            	496, 1422,
            	512, 1,
            	8, 1,
            	1125, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	20, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	808, 41,
            	1272, 8,
            	1677, 16,
            	1677, 24,
            	1677, 32,
            	341, 80,
            	10, 88,
            	10, 104,
            	1707, 120,
            	1733, 128,
            	989, 136,
            	10, 160,
            	141, 176,
            	121, 184,
            	121, 192,
            	1042, 208,
            	1047, 216,
            	936, 224,
            	1042, 232,
            	1047, 240,
            	936, 248,
            	1298, 256,
            	914, 304,
            	1204, 368,
            	153, 392,
            	121, 408,
            	10, 472,
            	10, 480,
            	121, 504,
            	121, 512,
            	10, 520,
            	10, 544,
            	10, 560,
            	10, 568,
            	23, 584,
            	10, 600,
            	10, 616,
            	1204, 624,
            	10, 632,
            	121, 648,
            	0, 656,
            	1303, 680,
            	1, 8,
            	1, 1682,
            	0, 0,
            	112, 6,
            	1697, 0,
            	10, 16,
            	10, 48,
            	1677, 56,
            	1677, 64,
            	153, 96,
            	1, 8,
            	1, 1702,
            	0, 0,
            	80, 1,
            	10, 8,
            	1, 8,
            	1, 1712,
            	0, 0,
            	344, 9,
            	10, 24,
            	10, 56,
            	10, 64,
            	10, 72,
            	10, 104,
            	10, 112,
            	10, 120,
            	10, 128,
            	10, 136,
            	1, 8,
            	1, 1738,
            	0, 0,
            	1200, 10,
            	1761, 240,
            	1761, 264,
            	1766, 288,
            	1766, 344,
            	10, 432,
            	1677, 440,
            	1775, 448,
            	10, 496,
            	10, 512,
            	1403, 528,
            	0, 24,
            	1, 10,
            	0, 0,
            	56, 3,
            	10, 16,
            	10, 24,
            	10, 32,
            	1, 8,
            	1, 1047,
            	0, 0,
            	2, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 24,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 1,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	64, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 8,
            	0, 0,
            	0, 0,
            	0, 48,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	32, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	20, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	1, 8,
            	1, 1592,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	0, 16,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	16, 0,
            	0, 0,
            	0, 0,
            	72, 0,
            	0, 8,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
        },
        .arg_entity_index = { 2065, },
        .ret_entity_index = 214,
    };
    struct lib_enter_args *args_addr = &args;
    populate_arg(args_addr, arg_a);
    populate_ret(args_addr, ret);

    struct lib_enter_args *new_args = (struct lib_enter_args *)syscall(888, args_addr);

    const SSL * new_arg_a = *((const SSL * *)new_args->args[0]);

    X509 * *new_ret_ptr = (X509 * *)new_args->ret;

    X509 * (*orig_SSL_get_certificate)(const SSL *);
    orig_SSL_get_certificate = dlsym(RTLD_NEXT, "SSL_get_certificate");
    *new_ret_ptr = (*orig_SSL_get_certificate)(new_arg_a);

    syscall(889);

    return ret;
}

