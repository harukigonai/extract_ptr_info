#define _GNU_SOURCE

#include <stdio.h>
#include <dlfcn.h>
#include <sys/syscall.h>
#include <unistd.h>
#include <openssl/crypto.h>
#include <openssl/err.h>
#include <openssl/x509.h>
#include <openssl/x509v3.h>
#include <openssl/pem.h>
#include <openssl/pkcs12.h>
#include <openssl/ui.h>
#include <openssl/safestack.h>
#include <openssl/ssl.h>
#include <openssl/e_os2.h>
#include <openssl/crypto.h>
#include <openssl/err.h>
#include <openssl/ssl.h>
#include <openssl/evp.h>
#include <openssl/bn.h>
#include <openssl/x509v3.h>
#include <openssl/ocsp.h>
#include <openssl/srp.h>

#include "../arg_struct.h"

const char * bb_SSL_get_servername(const SSL * arg_a,const int arg_b);

const char * SSL_get_servername(const SSL * arg_a,const int arg_b) 
{
    unsigned long in_lib = syscall(890);
    printf("SSL_get_servername called %lu\n", in_lib);
    if (!in_lib)
        return bb_SSL_get_servername(arg_a,arg_b);
    else {
        const char * (*orig_SSL_get_servername)(const SSL *,const int);
        orig_SSL_get_servername = dlsym(RTLD_NEXT, "SSL_get_servername");
        return orig_SSL_get_servername(arg_a,arg_b);
    }
}

const char * bb_SSL_get_servername(const SSL * arg_a,const int arg_b) 
{
    const char * ret;

    struct lib_enter_args args = {
        .num_args = 0,
        .entity_metadata = {
            1, 8, 1, /* 0: pointer.struct.iovec */
            	5, 0,
            0, 16, 1, /* 5: struct.iovec */
            	10, 0,
            1, 8, 1, /* 10: pointer.char */
            	4096, 0,
            0, 0, 0, /* 15: func */
            0, 16, 1, /* 18: struct.tls_session_ticket_ext_st */
            	10, 8,
            1, 8, 1, /* 23: pointer.struct.tls_session_ticket_ext_st */
            	18, 0,
            4097, 48, 94416323230591, /* 28: pointer.func */
            	0, 8,
            	1, 36,
            	0, 1,
            	8, 1,
            	31, 0,
            	1, 8,
            	1, 46,
            	0, 0,
            	24, 1,
            	36, 16,
            	0, 0,
            	0, 4097,
            	94396381778400, 94396381808336,
            	4097, 94396372726320,
            	33, 0,
            	0, 0,
            	4097, 94416323225599,
            	94396381796336, 0,
            	0, 0,
            	4097, 94396381789488,
            	94396381770224, 0,
            	0, 0,
            	0, 44,
            	0, 0,
            	0, 0,
            	4097, 672,
            	48, 1,
            	8, 1,
            	89, 0,
            	0, 4,
            	0, 4097,
            	94396381810896, 768,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	94396381772064, 94396377133680,
            	0, 0,
            	0, 0,
            	144, 4,
            	121, 8,
            	121, 16,
            	141, 24,
            	153, 120,
            	1, 8,
            	1, 126,
            	0, 0,
            	32, 1,
            	131, 0,
            	0, 32,
            	1, 136,
            	8, 1,
            	8, 1,
            	10, 0,
            	1, 8,
            	1, 146,
            	0, 0,
            	56, 2,
            	10, 0,
            	121, 48,
            	0, 16,
            	1, 121,
            	0, 1,
            	8, 1,
            	110, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 94396381772288,
            	94396381808688, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	753, 94396381775072,
            	0, 296,
            	5, 200,
            	0, 620,
            	48, 714,
            	64, 746,
            	80, 828,
            	96, 1,
            	8, 1,
            	205, 0,
            	0, 24,
            	3, 214,
            	0, 377,
            	8, 612,
            	16, 1,
            	8, 1,
            	219, 0,
            	0, 184,
            	12, 246,
            	0, 286,
            	8, 276,
            	16, 10,
            	32, 153,
            	40, 276,
            	104, 542,
            	112, 556,
            	120, 121,
            	128, 121,
            	136, 582,
            	144, 594,
            	176, 1,
            	8, 1,
            	251, 0,
            	0, 104,
            	11, 276,
            	0, 276,
            	8, 286,
            	16, 327,
            	24, 351,
            	32, 327,
            	40, 363,
            	48, 276,
            	56, 276,
            	64, 121,
            	72, 537,
            	80, 1,
            	8, 1,
            	281, 0,
            	0, 24,
            	1, 10,
            	8, 1,
            	8, 1,
            	291, 0,
            	0, 16,
            	2, 298,
            	0, 312,
            	8, 1,
            	8, 1,
            	303, 0,
            	0, 40,
            	3, 10,
            	0, 10,
            	8, 10,
            	24, 1,
            	8, 1,
            	317, 0,
            	0, 16,
            	1, 322,
            	8, 0,
            	8, 1,
            	10, 0,
            	1, 8,
            	1, 332,
            	0, 0,
            	40, 3,
            	121, 0,
            	341, 16,
            	10, 24,
            	1, 8,
            	1, 346,
            	0, 0,
            	24, 1,
            	10, 8,
            	1, 8,
            	1, 356,
            	0, 0,
            	16, 2,
            	276, 0,
            	276, 8,
            	1, 8,
            	1, 368,
            	0, 0,
            	24, 3,
            	286, 0,
            	276, 8,
            	377, 16,
            	1, 8,
            	1, 382,
            	0, 0,
            	56, 4,
            	393, 16,
            	415, 24,
            	322, 32,
            	121, 48,
            	1, 8,
            	1, 398,
            	0, 0,
            	208, 3,
            	10, 16,
            	10, 24,
            	407, 32,
            	1, 8,
            	1, 412,
            	0, 0,
            	0, 0,
            	1, 8,
            	1, 420,
            	0, 0,
            	216, 13,
            	10, 0,
            	10, 8,
            	449, 16,
            	461, 24,
            	473, 32,
            	485, 40,
            	497, 48,
            	509, 56,
            	517, 64,
            	525, 160,
            	153, 184,
            	415, 200,
            	415, 208,
            	1, 8,
            	1, 454,
            	0, 0,
            	112, 2,
            	10, 0,
            	10, 80,
            	1, 8,
            	1, 466,
            	0, 0,
            	96, 2,
            	10, 0,
            	10, 72,
            	1, 8,
            	1, 478,
            	0, 0,
            	72, 2,
            	10, 0,
            	10, 56,
            	1, 8,
            	1, 490,
            	0, 0,
            	32, 2,
            	10, 0,
            	10, 24,
            	1, 8,
            	1, 502,
            	0, 0,
            	48, 2,
            	10, 0,
            	10, 40,
            	1, 8,
            	1, 514,
            	0, 0,
            	48, 0,
            	1, 8,
            	1, 522,
            	0, 0,
            	0, 0,
            	1, 8,
            	1, 530,
            	0, 0,
            	32, 2,
            	10, 8,
            	10, 16,
            	0, 24,
            	1, 10,
            	0, 1,
            	8, 1,
            	547, 0,
            	0, 24,
            	3, 276,
            	0, 121,
            	8, 276,
            	16, 1,
            	8, 1,
            	561, 0,
            	0, 40,
            	2, 568,
            	0, 121,
            	8, 1,
            	8, 1,
            	573, 0,
            	0, 32,
            	3, 298,
            	8, 121,
            	16, 121,
            	24, 1,
            	8, 1,
            	587, 0,
            	0, 16,
            	2, 121,
            	0, 121,
            	8, 1,
            	8, 1,
            	599, 0,
            	0, 40,
            	5, 121,
            	0, 121,
            	8, 276,
            	16, 276,
            	24, 121,
            	32, 1,
            	8, 1,
            	617, 0,
            	0, 120,
            	0, 1,
            	8, 1,
            	625, 0,
            	0, 168,
            	17, 449,
            	16, 415,
            	24, 662,
            	32, 662,
            	40, 662,
            	48, 662,
            	56, 662,
            	64, 662,
            	72, 662,
            	80, 662,
            	88, 153,
            	96, 680,
            	120, 680,
            	128, 680,
            	136, 10,
            	144, 694,
            	152, 694,
            	160, 1,
            	8, 1,
            	667, 0,
            	0, 24,
            	1, 672,
            	0, 1,
            	8, 1,
            	677, 0,
            	0, 4,
            	0, 1,
            	8, 1,
            	685, 0,
            	0, 96,
            	3, 667,
            	8, 667,
            	32, 667,
            	56, 1,
            	8, 1,
            	699, 0,
            	0, 88,
            	6, 662,
            	0, 662,
            	8, 662,
            	16, 662,
            	24, 5,
            	40, 680,
            	72, 1,
            	8, 1,
            	719, 0,
            	0, 144,
            	12, 662,
            	8, 662,
            	16, 662,
            	32, 662,
            	40, 680,
            	56, 662,
            	64, 662,
            	72, 10,
            	80, 662,
            	96, 153,
            	112, 473,
            	128, 415,
            	136, 1,
            	8, 1,
            	751, 0,
            	0, 56,
            	4, 762,
            	8, 800,
            	16, 662,
            	24, 816,
            	48, 1,
            	8, 1,
            	767, 0,
            	0, 232,
            	11, 792,
            	0, 800,
            	8, 667,
            	16, 667,
            	40, 10,
            	80, 816,
            	96, 667,
            	104, 667,
            	152, 667,
            	176, 10,
            	208, 10,
            	216, 1,
            	8, 1,
            	797, 0,
            	0, 304,
            	0, 1,
            	8, 1,
            	805, 0,
            	0, 88,
            	4, 792,
            	0, 667,
            	8, 667,
            	32, 667,
            	56, 1,
            	8, 1,
            	821, 0,
            	0, 40,
            	2, 816,
            	0, 10,
            	8, 0,
            	192, 8,
            	205, 0,
            	205, 24,
            	205, 48,
            	205, 72,
            	205, 96,
            	205, 120,
            	205, 144,
            	205, 168,
            	0, 0,
            	0, 0,
            	12, 0,
            	4097, 0,
            	97, 0,
            	0, 0,
            	0, 248,
            	6, 121,
            	0, 200,
            	16, 828,
            	24, 620,
            	216, 714,
            	224, 746,
            	232, 0,
            	352, 14,
            	10, 144,
            	10, 152,
            	905, 168,
            	214, 176,
            	910, 224,
            	121, 240,
            	153, 248,
            	920, 264,
            	920, 272,
            	10, 280,
            	10, 296,
            	10, 312,
            	10, 320,
            	10, 344,
            	1, 8,
            	1, 859,
            	0, 1,
            	8, 1,
            	915, 0,
            	0, 88,
            	1, 10,
            	8, 1,
            	8, 1,
            	874, 0,
            	0, 56,
            	2, 932,
            	0, 153,
            	40, 1,
            	8, 1,
            	937, 0,
            	0, 64,
            	1, 10,
            	8, 1,
            	8, 1,
            	925, 0,
            	0, 168,
            	4, 958,
            	0, 415,
            	8, 10,
            	96, 10,
            	120, 1,
            	8, 1,
            	963, 0,
            	0, 88,
            	1, 10,
            	80, 4097,
            	94396374906704, 0,
            	1, 8,
            	1, 976,
            	0, 0,
            	24, 2,
            	10, 8,
            	971, 16,
            	4097, 94396381796624,
            	94396381774640, 0,
            	16, 0,
            	0, 2,
            	0, 0,
            	256, 0,
            	1, 8,
            	1, 1000,
            	0, 0,
            	888, 7,
            	1017, 576,
            	1017, 592,
            	1022, 608,
            	1022, 616,
            	1017, 624,
            	1032, 648,
            	1032, 736,
            	0, 16,
            	1, 1022,
            	8, 1,
            	8, 1,
            	1027, 0,
            	0, 16,
            	1, 971,
            	0, 0,
            	88, 1,
            	1037, 48,
            	0, 40,
            	4, 1048,
            	0, 1053,
            	8, 942,
            	16, 920,
            	24, 1,
            	8, 1,
            	947, 0,
            	1, 8,
            	1, 1058,
            	0, 0,
            	48, 4,
            	612, 0,
            	415, 8,
            	10, 24,
            	1069, 32,
            	1, 8,
            	1, 1074,
            	0, 0,
            	80, 8,
            	1093, 0,
            	415, 8,
            	377, 16,
            	377, 24,
            	10, 40,
            	10, 48,
            	407, 56,
            	672, 64,
            	1, 8,
            	1, 1098,
            	0, 0,
            	208, 9,
            	407, 8,
            	407, 32,
            	407, 48,
            	407, 64,
            	407, 80,
            	407, 96,
            	407, 144,
            	407, 160,
            	407, 176,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	48, 94416323456209,
            	0, 24,
            	2, 10,
            	8, 932,
            	16, 4097,
            	48, 94416323227425,
            	0, 0,
            	0, 4097,
            	33, 94396381796704,
            	0, 0,
            	0, 4097,
            	94396381810016, 94396381802416,
            	0, 0,
            	0, 4097,
            	140425329646816, 0,
            	0, 9,
            	0, 0,
            	0, 0,
            	4097, 94396374778736,
            	33, 4097,
            	94396381796784, 288,
            	0, 0,
            	0, 4097,
            	94396381782240, 94396374993392,
            	0, 0,
            	0, 4097,
            	48, 94416323223313,
            	0, 0,
            	0, 4097,
            	113, 94396381808128,
            	4097, 32,
            	48, 0,
            	0, 0,
            	4097, 94396374824144,
            	33, 0,
            	0, 0,
            	4097, 94416323467281,
            	94396381782240, 0,
            	0, 0,
            	4097, 94396381795728,
            	94396381813168, 1,
            	8, 1,
            	1215, 0,
            	0, 736,
            	30, 1278,
            	0, 121,
            	8, 121,
            	16, 158,
            	24, 84,
            	32, 920,
            	48, 920,
            	56, 10,
            	160, 10,
            	176, 153,
            	208, 612,
            	224, 612,
            	232, 612,
            	240, 121,
            	248, 121,
            	256, 121,
            	272, 1304,
            	304, 10,
            	328, 141,
            	392, 415,
            	408, 10,
            	424, 10,
            	496, 10,
            	512, 10,
            	520, 41,
            	552, 41,
            	560, 1309,
            	568, 10,
            	704, 10,
            	720, 121,
            	728, 1,
            	8, 1,
            	1283, 0,
            	0, 232,
            	1, 1288,
            	200, 1,
            	8, 1,
            	1293, 0,
            	0, 112,
            	4, 407,
            	0, 407,
            	32, 10,
            	64, 10,
            	80, 1,
            	8, 1,
            	187, 0,
            	0, 128,
            	11, 10,
            	0, 10,
            	32, 662,
            	40, 662,
            	48, 662,
            	56, 662,
            	64, 662,
            	72, 662,
            	80, 662,
            	88, 662,
            	96, 10,
            	104, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	8, 0,
            	4097, 0,
            	0, 0,
            	12, 0,
            	4097, 0,
            	0, 0,
            	128, 0,
            	0, 528,
            	8, 910,
            	408, 714,
            	416, 746,
            	424, 121,
            	464, 10,
            	480, 958,
            	488, 612,
            	496, 1428,
            	512, 1,
            	8, 1,
            	1131, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	20, 0,
            	1, 8,
            	1, 1468,
            	0, 0,
            	80, 1,
            	10, 8,
            	0, 1,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 24,
            	1, 10,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	0, 56,
            	3, 10,
            	16, 10,
            	24, 10,
            	32, 0,
            	0, 0,
            	0, 2,
            	0, 0,
            	72, 0,
            	0, 48,
            	0, 0,
            	1200, 10,
            	1503, 240,
            	1503, 264,
            	1517, 288,
            	1517, 344,
            	10, 432,
            	1561, 440,
            	1581, 448,
            	10, 496,
            	10, 512,
            	1409, 528,
            	1, 8,
            	1, 1566,
            	0, 0,
            	112, 6,
            	1463, 0,
            	10, 16,
            	10, 48,
            	1561, 56,
            	1561, 64,
            	153, 96,
            	1, 8,
            	1, 1053,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	32, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	8, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	0, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 0,
            	0, 1,
            	8, 1,
            	1693, 0,
            	0, 808,
            	41, 1278,
            	8, 1561,
            	16, 1561,
            	24, 1561,
            	32, 341,
            	80, 10,
            	88, 10,
            	104, 1778,
            	120, 1804,
            	128, 995,
            	136, 10,
            	160, 141,
            	176, 121,
            	184, 121,
            	192, 1048,
            	208, 1053,
            	216, 942,
            	224, 1048,
            	232, 1053,
            	240, 942,
            	248, 1304,
            	256, 920,
            	304, 1210,
            	368, 153,
            	392, 121,
            	408, 10,
            	472, 10,
            	480, 121,
            	504, 121,
            	512, 10,
            	520, 10,
            	544, 10,
            	560, 10,
            	568, 23,
            	584, 10,
            	600, 10,
            	616, 1210,
            	624, 10,
            	632, 121,
            	648, 0,
            	656, 1309,
            	680, 1,
            	8, 1,
            	1783, 0,
            	0, 344,
            	9, 10,
            	24, 10,
            	56, 10,
            	64, 10,
            	72, 10,
            	104, 10,
            	112, 10,
            	120, 10,
            	128, 10,
            	136, 1,
            	8, 1,
            	1538, 0,
            	4097, 32,
            	48, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	94396381801824, 112,
            	0, 16,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	48, 94416323460066,
            	0, 0,
            	0, 0,
            	8, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 94396381267520,
            	33, 0,
            	0, 0,
            	4097, 94416323461858,
            	94396381785792, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 14976,
            	48, 0,
            	0, 0,
            	4097, 94396381479152,
            	33, 0,
            	0, 0,
            	4097, 94416323460594,
            	94396381802000, 4097,
            	94396381773600, 94396381499952,
            	4097, 94396381811008,
            	140425329646816, 4097,
            	0, 94396381796464,
            	0, 0,
            	0, 4097,
            	94396381808368, 96,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	48, 94416323472690,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	94396381770304, 192,
            	0, 0,
            	0, 4097,
            	0, 94396375385696,
            	0, 0,
            	0, 4097,
            	48, 94416323456787,
            	4097, 94396381777920,
            	94396381807616, 0,
            	0, 0,
            	4097, 32,
            	48, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	94396381814240, 32,
            	0, 0,
            	0, 4097,
            	0, 94396372325904,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 32,
            	48, 4097,
            	94396381803216, 94396381778000,
            	4097, 94396372581840,
            	113, 0,
            	0, 0,
            	4097, 94416323219699,
            	94396381807856, 4097,
            	94396381773072, 94396372379568,
            	4097, 94396381787328,
            	94396381790720, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 32,
            	48, 4097,
            	94396381773744, 94396381778640,
            	4097, 94396372540560,
            	33, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 94396381790096,
            	94396381774304, 4097,
            	48, 94416323224115,
            	0, 0,
            	0, 4097,
            	33, 94396381813328,
            	0, 0,
            	0, 0,
            	64, 0,
            	4097, 320,
            	48, 4097,
            	94396381785168, 0,
            	0, 0,
            	0, 0,
            	24, 0,
            	4097, 94416323467715,
            	94396375960560, 4097,
            	48, 94416323237187,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	94396381770576, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 94416323238643,
            	94396381796752, 4097,
            	0, 94396375224704,
            	4097, 94396381813808,
            	94396381803888, 0,
            	0, 0,
            	4097, 0,
            	0, 4097,
            	2673, 94396381788464,
            	4097, 0,
            	0, 0,
            	0, 0,
            	4097, 94396377096528,
            	33, 0,
            	0, 0,
            	4097, 94416323465747,
            	94396381804272, 4097,
            	94396381806336, 160,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 94396381778240,
            	140425329646816, 4097,
            	94396381804432, 94396379971648,
            	4097, 94396381783088,
            	94396381807424, 4097,
            	48, 94416323461027,
            	4097, 0,
            	0, 4097,
            	33, 94396381803888,
            	4097, 112,
            	48, 4097,
            	94396381810256, 94396381804016,
            	0, 0,
            	0, 4097,
            	94396381770656, 32,
            	4097, 94416323231347,
            	94396381778592, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	48, 94416323453059,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	94396372635504, 1,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	1953, 94396381779344,
            	4097, 0,
            	0, 4097,
            	94396381802896, 0,
            	4097, 94396377080016,
            	33, 0,
            	20, 0,
            	4097, 94416323217123,
            	94396381781856, 0,
            	0, 0,
            	4097, 94396381807008,
            	94396381805088, 4097,
            	48, 94416323459123,
            	4097, 94396381779696,
            	94396381811936, 4097,
            	1713, 94396381812528,
            	4097, 0,
            	0, 4097,
            	94396381805504, 0,
            	0, 0,
            	0, 4097,
            	94396381785920, 32,
            	0, 0,
            	0, 4097,
            	0, 94396377869040,
            	4097, 94396381804768,
            	94396381805088, 0,
            	0, 0,
            	4097, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 94396379239616,
            	401, 4097,
            	140425329646816, 32,
            	4097, 94416323229555,
            	94396381783696, 4097,
            	0, 94396376534560,
            	0, 0,
            	0, 4097,
            	48, 94416323227283,
            	0, 0,
            	0, 4097,
            	161, 94396381807232,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 94396377298800,
            	81, 0,
            	0, 0,
            	4097, 94416323456547,
            	94396381779840, 0,
            	16, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	48, 94416323231731,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 4097,
            	94396381796896, 94396381796016,
            	4097, 94396379648960,
            	625, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 94396376670784,
            	97, 4097,
            	94396381811648, 32,
            	4097, 94416323458195,
            	94396372627248, 4097,
            	33, 94396381781680,
            	0, 0,
            	0, 0,
            	0, 0,
            	4097, 94396379243744,
            	385, 4097,
            	94396381809088, 32,
            	4097, 94416323465475,
            	94396373623856, 64,
        },
        .arg_entity_index = { 1688, 677, },
        .ret_entity_index = 10,
    };
    struct lib_enter_args *args_addr = &args;
    populate_arg(args_addr, arg_a);
    populate_arg(args_addr, arg_b);
    populate_ret(args_addr, ret);

    struct lib_enter_args *new_args = (struct lib_enter_args *)syscall(888, args_addr);

    const SSL * new_arg_a = *((const SSL * *)new_args->args[0]);

    const int new_arg_b = *((const int *)new_args->args[1]);

    const char * *new_ret_ptr = (const char * *)new_args->ret;

    const char * (*orig_SSL_get_servername)(const SSL *,const int);
    orig_SSL_get_servername = dlsym(RTLD_NEXT, "SSL_get_servername");
    *new_ret_ptr = (*orig_SSL_get_servername)(new_arg_a,new_arg_b);

    syscall(889);

    return ret;
}

